!function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=17)}([function(t,e,s){"use strict";const i=s(16);t.exports=class{constructor(){this.sizeBlock=new i(50,50),this.numBlocks=new i(1024,1024)}}},function(t,e,s){"use strict";const i=new(s(0)),r=(s(4),s(11));t.exports=class t{constructor(e){this.state=e,this.size=t.getSize(e),this.afterWorldRenderDoing=[]}static getSize(t){if(!0===t.getSizeWorld().firstFindSize){const e=Math.floor(window.innerWidth/i.sizeBlock.width),s=Math.floor(window.innerHeight/i.sizeBlock.height);let r={widthBlocks:e<i.numBlocks.width?e:i.numBlocks.width,heightBlocks:s<i.numBlocks.height?s:i.numBlocks.height};return t.setFirstFindSize({firstFindSize:!0,sizeG:r}),r}return t.getSizeWorld().sizeG}static makeAroayWihtEnemy(e,s){t.getSize(s);let o=[];for(let t=0;t<e;t++){let e={};e.coor=new r,e.type="slime",e.coor.x=Math.floor(Math.random()*(i.numBlocks.height-2))+1,e.coor.y=Math.floor(Math.random()*(i.numBlocks.width-2))+1,o[t]=e}return o}setAfterWorldRenderDoing(t){this.afterWorldRenderDoing.push(t)}doAfterWorldRenderDoing(){this.afterWorldRenderDoing.forEach(t=>{t()})}renderWorld(t){const e=this.state,s=this.size,r=e.getBias(!0);if(null===r&&!0===t){let t=function(){let t=document.createElement("div");return t.className="world",t}();return function(t,e,s){const i=e.getStartPiointWatch().x,r=e.getStartPiointWatch().y,o=e.getAllPlace();for(let e=i;e<i+s.heightBlocks;e++){let i=document.createElement("div");i.className="row";for(let t=r;t<r+s.widthBlocks;t++){let s=n(o[e][t],{newX:e,newY:t});i.appendChild(s)}t.appendChild(i)}}(t,e,s),function(){let t=e.getWorldDiv();null!==t&&(t.remove(),e.setWorldDiv=null)}(),t=t,document.querySelector(".wrapper").appendChild(t),t}var o;return!0===function(t,e,s){const r=e.getStartPiointWatch(),o=e.getPiointWatch();if((0===r.x||r.x===i.numBlocks.height-t.heightBlocks)&&(o.x<Math.floor(t.heightBlocks/2)||o.x>=i.numBlocks.height-Math.floor(t.heightBlocks/2))&&("up"===s||"down"===s)||(0===r.y||r.y===i.numBlocks.width-t.widthBlocks)&&(o.y<Math.floor(t.widthBlocks/2)||o.y>=i.numBlocks.width-Math.floor(t.widthBlocks/2))&&("left"===s||"right"===s))return!1;return!0}(s,e,r)&&(!function(t,e){const s=t.state,i=t.size,r=s.getAllPlace(),o=s.getWorldDiv();s.getStartPiointWatch();if("right"===e||"left"===e)!function(){const t=s.getStartPiointWatch().x;for(let a=t;a<t+i.heightBlocks;a++){let l=0,h=0,u=null;"right"===e?(l=s.getStartPiointWatch().y+i.widthBlocks,h=l-i.widthBlocks):"left"===e&&(l=s.getStartPiointWatch().y-1,h=l+i.widthBlocks),u=n(r[a][l],{newX:a,newY:l},!0),!0===r[a][h].isCreature&&c(r[a][h]);let d=o.children[a-t],f=0;"right"===e?(f=0,d.children[f].remove(),d.appendChild(u)):"left"===e&&(f=d.children.length-1,d.children[f].remove(),d.insertBefore(u,o.children[a-t].children[0]))}}();else{if("up"!==e&&"down"!==e)return!1;!function(){const t=s.getStartPiointWatch().y;let a=document.createElement("div");a.className="row";for(let o=t;o<t+i.widthBlocks;o++){let t=0,l=0;"up"===e?(t=s.getStartPiointWatch().x-1,l=t+i.heightBlocks):(t=s.getStartPiointWatch().x+i.heightBlocks,l=t-i.heightBlocks);let h=n(r[t][o],{newX:t,newY:o},!0);a.appendChild(h),!0===r[l][o].isCreature&&c(r[l][o])}"up"===e?(o.children[o.children.length-1].remove(),o.insertBefore(a,o.children[0])):"down"===e&&(o.children[0].remove(),o.appendChild(a))}()}return t.doAfterWorldRenderDoing(),s.changePointWatch(e),!0}(this,r),e.changeStartPointWatch(r)),!0;function n(t,e,s){let i=document.createElement("div");return!0===t.nesting?(i.className="standartPlace "+t.classNameBackBlock,!0===t.isCreature&&(!function(t,e,i){let r=document.createElement("div");r.className=e.classNameCSS,t.appendChild(r),!0===s&&(e.visable.was=!1,e.visable.now=!0)}(i,t),t.DOMObject=i),t.visable={was:t.visable.now,now:!0}):i.className="standartPlace "+t.classNameCSS,i}function c(t){t.visable.was=!0,t.visable.now=!1}}}},function(t,e,s){"use strict";const i=new(s(0)),r=(s(11),s(19)),o=s(1),n=s(18);t.exports=class{constructor(t,e,s){this.isCreature=!0,this.patency=!1,this.nesting=!0,this.state=e,this.id=t,this.coor=s,this.visable={},this.visable.was=!1,this.visable.now=!1,this.visable=this._identifyVisable({newX:s.x,newY:s.y},e),this.classNameCSS="",this.classNameBackBlock="dirt",this.idBackBlock=1,this.DOMObject=null,this.health=100,this.attackDamage=20,this.attackRange=100,this.pursuitRange=10,e.setCoorPlayer(s,t)}movePerformance(t){if("rand"===t){const t=this.state.getWatcher(),e=t.coor.x,s=t.coor.y,i=this.coor.x,r=this.coor.y,o=this.pursuitRange;e>i-o&&e<i+o&&s<r+o&&s>r-o?this._approximatingToWatcher():this._randMove()}else this._move(t)}doAttack(t){const e=this,s=this.state,r=s.getWorldObject();!function(t){const n=e.DOMObject.getBoundingClientRect();let c=document.createElement("div");c.className="stackWeaponBall",c.style.left=n.x+"px",c.style.top=n.y+"px",e.state.getWeaponDiv().appendChild(c),setTimeout(()=>{let r=0,a=0;switch(t){case"left":r=n.x-e.attackRange*i.sizeBlock.width,c.style.left=(r<0?0:r)+"px";break;case"right":r=n.x+e.attackRange*i.sizeBlock.width,a=i.sizeBlock.width*(o.getSize(s).widthBlocks-1),c.style.left=(r>a?a:r)+"px";break;case"up":r=n.y-e.attackRange*i.sizeBlock.height,c.style.top=(r<0?0:r)+"px";break;case"down":r=n.y+e.attackRange*i.sizeBlock.height,a=i.sizeBlock.height*(o.getSize(s).heightBlocks-1),c.style.top=(r>a?a:r)+"px"}setTimeout(()=>{c.remove()},2e3)},100),!1===lisenAttack&&(r.setAfterWorldRenderDoing(()=>{s.getWeaponDiv()}),lisenAttack=!0)}(t)}_identifyVisable(t,e){const s={};if(!0===this.watcher)s.now=!0,s.was=!0;else{const i=this.state.getStartPiointWatch(),r=o.getSize(e);s.was=this.visable.now,t.newX-i.x<r.heightBlocks&&t.newY-i.y<r.widthBlocks&&t.newX-i.x>=0&&t.newY-i.y>=0?s.now=!0:s.now=!1}return s}_move(t){const e=this.id,s=this.state;let o=s.getCreature(e).coor.x,c=s.getCreature(e).coor.y,a=new r(o,c,o,c),l=null;switch(t){case"right":if(i.numBlocks.width<=a.y+1)return!1;a.newY++,l=s.getCellPlace({x:a.x,y:a.y+1});break;case"left":if(0>a.y-1)return!1;a.newY--,l=s.getCellPlace({x:a.x,y:a.y-1});break;case"up":if(0>a.x-1)return!1;a.newX--,l=s.getCellPlace({x:a.x-1,y:a.y});break;case"down":if(i.numBlocks.height<=a.x+1)return!1;a.newX++,l=s.getCellPlace({x:a.x+1,y:a.y});break;default:throw"empty direction on move creature: "+this.id}return!0===l.patency&&function(s,i){!0===i.watcher&&function(t,e,s){e.state.setBias(s),e.state.setPointWatch({x:t.newX,y:t.newY},e)}(s,i,t);const r=i.state;return i.visable=i._identifyVisable(s,r),i._movingVisableSwapingIcon(s,r),function(t,s){t.state.setCellPlace({x:t.state.getCreature(e).coor.x,y:t.state.getCreature(e).coor.y},n.getBlockObject(t.idBackBlock)),t.state.changeCoorPlayer({x:s.newX,y:s.newY},e),t.state.setCellPlace({x:s.newX,y:s.newY},t),t.coor.x=s.newX,t.coor.y=s.newY}(i.state.getCreature(e),s),!0}(a,this)}_randMove(){let t="";switch(Math.floor(4*Math.random())+1){case 1:t="left";break;case 2:t="right";break;case 3:t="up";break;case 4:t="down"}return this._move(t),!0}_approximatingToWatcher(){const t=this.pursuitRange,e=2*t+1+2,s=this.state.getAllPlace(),i=this.coor.x-t,r=this.coor.y-t;!function(){let t=[],o=null;for(let n=0;n<e;n++){t[n]=[];for(let c=0;c<e;c++)0===n||n===e-1||c===n||c===e-1?t[n][c]=1/0:!0===(o=s[i+n][r+c]).patency?t[n][c]=0:t[n][c]=1/0}}()}_movingVisableSwapingIcon(t,e){const s=this.state.getStartPiointWatch(),i=this.state.getWorldDiv();o.getSize(e);let r=function(t){let e=document.createElement("div");return e.className=t.classNameCSS,e}(this);return!0===this.visable.was&&(this.DOMObject.children[0].remove(),this.DOMObject=null),!0===this.visable.now&&(i.children[t.newX-s.x].children[t.newY-s.y].appendChild(r),this.DOMObject=r.parentNode),!0}}},function(t,e,s){"use strict";t.exports=class{constructor(){this.nesting=!1,this.isCreature=!1}}},function(t,e,s){"use strict";const i=s(12),r=s(10),o=s(18);s(11);t.exports=class{constructor(t){!function(e){const s=t.height,i=t.width;e._place=[];for(let t=0;t<s;t++){e._place[t]=[];for(let r=0;r<i;r++)e._place[t][r]=0===t||t+1===s||0===r||r+1===i?o.getBlockObject(2):o.getBlockObject(1)}return function(t){for(let e=0;e<s;e+=8)for(let r=0;r<i;r++){const n=Math.floor(400*Math.random());if(n>9&&n<25){for(let c=r;c<r+n&&c<i;c++)if(c===r)for(let i=e;i<e+n+1&&i<s;i++)t._place[i][c]=o.getBlockObject(2);else t._place[e][c]=o.getBlockObject(2),t._place[e+n>=s?e:e+n][c]=o.getBlockObject(2);r+=8}}}(e),e}(this),this._creature=[],this._pointWatch={},this._startPointWatch={x:0,y:0},this._bias=null,this._weaponDiv=null,this._worldDiv=null,this._worldObject=null,this._sizeWorld={firstFindSize:!0,sizeG:null}}getSizeWorld(){return this._sizeWorld}setFirstFindSize(t){this._sizeWorld=t}setCoorPlayer(t,e=0){return this._creature[e]={},this._creature[e].coor=t,!0}setPlayer(t=0,e){return this._creature[t]=new i(t,this,e.watcher,e.coor,e.type),this._place[e.coor.x][e.coor.y]=this._creature[t],!0}setEnemy(t=0,e){return this._creature[t]=new r(t,this,e.coor,e.type),this._place[e.coor.x][e.coor.y]=this._creature[t],!0}getCreature(t=0){return"number"==typeof+t&&this._creature[t]}getAllCreature(){return this._creature}getAllPlace(){return this._place}getCellPlace(t){return this._place[t.x][t.y]}setCellPlace(t,e){return!0===e.isCreature&&(e.idBackBlock=this._place[t.x][t.y].idBlock,e.classNameBackBlock=this._place[t.x][t.y].classNameCSS),this._place[t.x][t.y]=e,!0}changeCoorPlayer(t,e=0){return this._creature[e].coor.x=t.x,this._creature[e].coor.y=t.y,!0}setBias(t){return this._bias=t,!0}getBias(t){if(void 0!==this._bias){let e=this._bias;return!0===t&&(this._bias=null),e}return null}setPointWatch(t,e){return this._pointWatch.x=t.x,this._pointWatch.y=t.y,this._pointWatch.watcher=e,!0}changePointWatch(t){switch(t){case"right":this._pointWatch.y++;break;case"left":this._pointWatch.y--;break;case"up":this._pointWatch.x--;break;case"down":this._pointWatch.x++}return!0}getPiointWatch(){return this._pointWatch}setStartPointWatch(t){return this._startPointWatch.x=t.x,this._startPointWatch.y=t.y,!0}getStartPiointWatch(){return this._startPointWatch}changeStartPointWatch(t){switch(t){case"right":this._startPointWatch.y++;break;case"left":this._startPointWatch.y--;break;case"up":this._startPointWatch.x--;break;case"down":this._startPointWatch.x++}return!0}setWeaponDiv(t){return this._weaponDiv=t,!0}setWorldDiv(t){return this._worldDiv=t,!0}getWorldDiv(){return this._worldDiv}getWeaponDiv(){return this._weaponDiv}setWorldObject(t){return this._worldObject=t,!0}getWorldObject(){return this._worldObject}getWatcher(){return this._pointWatch.watcher?this._pointWatch.watcher:null}}},,,,,,function(t,e,s){"use strict";const i=s(2);t.exports=class extends i{constructor(t,e,s){super(t,e,s),this.type="enemy",this.classNameCSS="slimeEnemy",this.watcher=!1}}},function(t,e,s){"use strict";t.exports=class{constructor(t=0,e=0){this.x=t,this.y=e}}},function(t,e,s){"use strict";const i=s(2);t.exports=class extends i{constructor(t,e,s,i,r){switch(super(t,e,i),this.type="player",!0===s?(this.watcher=!0,e.setPointWatch(i,this),this.visable={was:!0,now:!0}):this.watcher=!1,r){case"mage":this.classNameCSS="magePlayer"}}}},function(t,e,s){"use strict";const i=s(3);t.exports=class extends i{constructor(){super(),this.type="dirt",this.idBlock=1,this.patency=!0,this.classNameCSS="dirt"}}},function(t,e,s){"use strict";const i=s(3);t.exports=class extends i{constructor(){super(),this.type="border",this.idBlock=2,this.patency=!1,this.classNameCSS="border"}}},function(t,e,s){"use strict";const i=s(4),r=s(1),o=new(s(0));t.exports=class{constructor(t=null,e=[]){let s=0;this.state=new i(o.numBlocks),function(t,e){null!==t&&t.forEach(t=>{e.setPlayer(s++,t)})}(t,this.state);const n=function(t,e){let s=t.filter(t=>t.watcher);if(1!==s.length)return!1;s=s[0];const i=r.getSize(e);let n=s.coor.x,c=s.coor.y,a={};return a.x=function(t,e){let s=0;return s=t<Math.floor(e.heightBlocks/2)?0:t>=o.numBlocks.height-Math.floor(e.heightBlocks/2)?o.numBlocks.height-Math.floor(e.heightBlocks/2):t-Math.floor(e.heightBlocks/2)+1}(n,i),a.y=function(t,e){let s=0;return s=t<Math.floor(e.widthBlocks/2)?0:t>=o.numBlocks.width-Math.floor(e.widthBlocks/2)?o.numBlocks.width-Math.floor(e.widthBlocks/2):t-Math.floor(e.widthBlocks/2)+1}(c,i),a}(t,this.state);if(!1===n)throw"2 or more main player or null";var c,a;this.state.setStartPointWatch(n),e=e.concat(r.makeAroayWihtEnemy(1e3,this.state)),c=e,a=this.state,null!==c&&c.forEach(t=>{a.setEnemy(s++,t)}),this.world=new r(this.state);const l=this.world.renderWorld(!0);this.weaponDiv=function(){let t=document.createElement("div");return t.className="weapon",document.querySelector("body").appendChild(t),t}(),this.state.setWeaponDiv(this.weaponDiv),this.state.setWorldDiv(l),this.state.setWorldObject(this.world)}getState(){return this.state}tactOfGame(){this.world.renderWorld(),this.state._creature.forEach(t=>{!0!==t.watcher&&t.movePerformance("rand")})}}},function(t,e,s){"use strict";t.exports=class{constructor(t=0,e=0){this.width=t,this.height=e}}},function(t,e,s){"use strict";new s(0);const i=new(s(15))([{coor:{x:1,y:1},type:"mage",watcher:!0}]),r=i.getState(),o=r.getCreature(0);document.onkeydown=function(t){68===t.keyCode?o.movePerformance("right"):83===t.keyCode?o.movePerformance("down"):87===t.keyCode?o.movePerformance("up"):65===t.keyCode?o.movePerformance("left"):39===t.keyCode?o.doAttack("right"):40===t.keyCode?o.doAttack("down"):38===t.keyCode?o.doAttack("up"):37===t.keyCode&&o.doAttack("left"),i.tactOfGame()},console.log(r)},function(t,e,s){"use strict";const i=s(14),r=s(13);t.exports=class{constructor(){}static getBlockObject(t){switch(t){case 1:return new r;case 2:return new i}}}},function(t,e,s){"use strict";const i=s(11);t.exports=class extends i{constructor(t=0,e=0,s=0,i=0){super(t,e),this.newX=s,this.newY=i}}}]);
//# sourceMappingURL=bundle.js.map